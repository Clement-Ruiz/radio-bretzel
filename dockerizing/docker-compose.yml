version: '2'  
services:  
  icecast:
    build:
      context: ./icecast/
      dockerfile: Dockerfile
    volumes:
      - ./icecast/config:/etc/icecast2
    image: icecast-bretzel
    ports: 
      - "8000:8000"
    hostname: icecast.bretzel
    networks:
      radiobretzel:
        aliases:
          - icecast
          - icecast.bretzel

  liquidsoap:
    build:
      context: ./liquidsoap/
      dockerfile: Dockerfile
    volumes:
      - ./liquidsoap:/home/liquy
    image: liquidsoap-bretzel
    hostname: liquidsoap.bretzel
    depends_on:
      - "icecast"
    networks:
      radiobretzel:
        aliases:
          - liquidsoap
          - liquidsoap.bretzel

  node:
    build:
      context: ./node/
      dockerfile: Dockerfile
    volumes:
      - ./node/server/src:/usr/src/app/src
    image: node-bretzel
    ports:
      - "80:8082"
    hostname: node.bretzel
    networks:
      radiobretzel:
        aliases:
          - node
          - node.bretzel

networks:
  radiobretzel:
    driver: bridge
    ipam:
      config:
      - subnet: 18.18.18.0/24 
